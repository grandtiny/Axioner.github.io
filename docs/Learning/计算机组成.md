# 计算机组成

## 1.计算机概述

## 2.数据的表示和运算

## 3.存储系统

### 3.1存储器概述

*   存储器的分类可以按在计算机中的作用分类、按存储介质分类、按存取方式分类、按信息的可保存性分类

*   串行访问存储器需要按照物理位置的先后顺序寻址，包括顺序存取存储器（磁带）和直接存取存储器（磁盘、光盘）

*   $$
    存储容量=存储字长*字长\\每位价格=总成本/总容量\\数据传输率=数据的宽度/存储周期
    $$

*   主存和辅存之间的数据调动由硬件和操作系统共同完成，对应用程序员透明

*   外存-辅存-内存-cache-寄存器-cpu

*   $$
    Random Access Memory（RAM）-随机存取存储器\\Dynamic Random Access Memory(DRAM)-动态RAM\\Static Random Access Memory（SRAM）-静态RAM
    $$

*   Sequential Access Memory SAM-顺序存取存储器

*   Direct Access Memory DAM-直接存取存储器

*   Associative Memory -相连存储器

*   Content Address Memory CAM-按内容访问的存储器

*   $$
    Read Only Memory（ROM）-只读存取器\\Mask Read Only Memory（MROM）-掩模式只读存储器\\Programmable Read Only Memory（MROM）-可编程只读存取器\\Erasable Programmable Read Only Memory（EPROM）-可擦除可编程只读存储器
    $$

*   Flash Memory -闪存

*   Solid State Drives SSD-固态硬盘

### 3.2主存储器

*   DRAM的刷新对CPU是透明的，即刷新不依赖于外部
*   SRAM的行列地址是同时送完，DRAM的行列地址是分两次送，所以地址线减半

### 3.3主存储器与CPU的连接

*   位扩展（在没有利用满数据总线时扩展）：CPU传输过来的地址总线对每一个存储都一样，传回去的地址总线各自占据不同位置
*   字扩展（在没有利用满地址总线时扩展）：多余的字可以选定不同的数据片工作，多3个字可以选择2^n^个数据片。

### 3.4外部存储器

*   磁盘存储器-磁盘驱动器、磁盘控制器、盘片

*   磁记录方式：调频制（FM）、改进型调频制（MFM）

*   磁盘的性能指标：记录密度、容量、平均存取时间、数据传输率

*   磁盘地址的一般形式：驱动器号-柱面（磁道）号-盘面号-扇区号

*   磁盘阵列RAID（独立冗余磁盘阵列）：多个独立物理盘组成一个独立逻辑盘

*   $$
    RAID0-无冗余和无校检的磁盘阵列\\RAID1-镜像磁盘阵列\\RAID2-采用纠错的海明码阵列\\RAID3-位交叉奇偶校验的磁盘阵列\\RAID4-块交叉奇偶校验的磁盘阵列\\RAID5-无独立校验的奇偶校验磁盘阵列
    $$

### 3.5高速缓冲存储器

*   程序访问的局部性原理：空间局部性-将要使用的信息和正在使用的信息在存储空间上时临近的、时间局部性-将要使用的信息可能正在使用的信息
*   Cache的三种地址映射：直接映射、全相联映射、组相联映射
*   Cache中贮存块的替换算法：随机（RAND）算法、先进先出（FIFO）算法、近期最少使用（LRU）算法、最不经常使用（LFU）算法
*   Cache写算法：全写法（write-through）-写命中时同时写cache和主存，为了降低时间损耗会在cache和主存中间加一个write buffer，写缓冲是一个FIFO队列，频繁写会导致写缓冲饱和溢出。回写法（write-back）-平时只写cache，需要替换该内存块时才会写回主存，为了减少写回主存的开销，会设置一个二进制脏位判断是否修改过。

### 3.6虚拟存储器

*   虚拟存储器对应用程序员来说是透明的，Cache则对所有程序员透明
*   访存操作流程：CPU给出虚拟地址，虚拟地址的对应表象有在快表（TLB）中时就将虚拟地址转化为物理地址，否则访问主存中的页表，如果页表存在就访问并根据替换原则将该表更新到TLB中，不存在则从磁盘中读出一页到主存，再更新页表和TLB；根据物理地址访问的对应主存块在Cache时则直接存取数据，不存在时根据替换原则从主存中访问并更新Cache。

### 3.7本章小结

*   存储器的层次结构主要体现在Cache-主存、主存-辅存这两个存储层次上。

## 4.指令系统

### 4.1 指令系统

*   指令集体系结构（ISA）

*   指令-操作码-地址码-指令长度-单字长指令-半字长指令-双字长指令-定长指令字结构-变长指令字结构
*   零地址指令：只有操作码，运用于不需要操作数的指令和堆栈计算机
*   一地址指令-二地址指令-三地址指令-四地址指令
*   扩展操作码指令格式，最后一位留给低位地址指令
*   指令操作类型：数据传送、算数和逻辑运算、移位、转移、输入输出
*   中断隐指令由硬件实现
*   单地址指令的两个操作数的算术运算中，一个操作数由地址码指出，另外一个在累加器中
*   寻址单元数的计算，编码位数的计算，扩展地址指令数的计算

### 4.2 指令的寻址方式

*   形式地址（A）、有效地址（EA）；带括号的时候表示指向到该地址的数据中
*   指令寻址-顺序寻址-跳跃寻址；数据寻址-指令字中多一段寻址特征
*   隐含寻址-立即数寻址-直接寻址-间接寻址-寄存器寻址-寄存器间接寻址-相对寻址-基址寻址-变址寻址-堆栈寻址
*   采用不同寻址方式的目的是为了缩短指令字长，扩大寻址空间，提高编程的灵活性，但这也提高了指令译码的复杂度。
*   程序控制是靠转移指令而非寻址方式实现

### 4.3 程序的机器级代码表示

*   mov复制、pop/push出栈入栈、add/sub加减、inc/dec自加自减、imul/idiv带符号乘除、and/or/xor与或异或、not位（0，1）翻转、neg取负、shl/shr逻辑左右移
*   jmp跳转、cmp/test比较和逐位与、call/ret调用返回
*   CF有借位1无借位0、ZF结果零1不零0、SF负号1其他0、OF溢出1否则0

### 4.4 CISC和RISC的基本概念

*   CISC：复杂指令系统计算机
*   RISC：精简指令系统计算机
*   RISC一定使用流水线，指令长度固定，访存指令有限制

## 5.中央处理器

### 5.1 CPU的功能和基本结构

*   控制器负责指令，运算器负责数据加工
*   运算器有：算术逻辑单元ALU、暂存寄存器、累加寄存器ACC、通用寄存器组、程序状态字寄存器PSW、移位器、计数器CT
*   控制器有：程序计数器PC、指令寄存器IR、指令译码器、存储器地址寄存器MAR、存储器数据寄存器MDR、时序系统、微操作信号发生器

### 5.2 指令执行过程

*   取址周期访存为了取指令、间址周期访存为了取有效地址、执行周期为了取操作数、中断周期为了保存程序断点
*   单指令周期-多指令周期-流水线方案

### 5.3 数据通路的功能和基本结构

*   CPU内部单总线方式-CPU内部多总线方式-专用数据通路方式
*   寄存器之间的数据传送-主存与CPU之间的数据传送-执行算术或逻辑运算

### 5.4 控制器的功能和工作原理

*   功能：取指令、指令译码、控制数据流动方向
*   硬布线控制器
*   时钟周期-机器周期-指令周期
*   CPU控制方式：同步控制方式-异步控制方式-联合控制方式
*   微程序控制器-微命令与微操作-微指令与微周期-微地址寄存器与微指令寄存器
*   微指令的编码方式：直接编码-字段直接编码-字段间接编码
*   水平型微指令-垂直型微指令-混合型微指令

### 5.6 指令流水线

*   时间并行-空间并行

*   取指（IF）-译码/读寄存器（ID）-执行/计算地址（EX）-访存（MEM）-写回（WB）

*   流水寄存器保存流水线暂存结果

*   结构冒险：资源冲突

*   数据冒险：数据脏读

*   控制冒险：执行转移

*   性能指标

    *   吞吐率TP=n/（k+n-1）△t（n任务数、
    *   

    

## 6.总线

### 6.1 总线概述

*   总线定义
*   主设备从设备
*   总线特性：机械特性、电气特性、功能特性、时间特性
*   总线分类：片内总线、系统总线、IO总线、通信总线
*   结构：单总线结构、双总线结构、三总线结构
*   总线标准：ISA、EISA、VESA、PCI。。。
*   性能指标：总线传输周期、总线时钟周期、总线工作频率、总线宽度、总线带宽、总线复用、信号线数

### 6.2 总线事务和定时

*   事务：请求阶段-仲裁阶段-寻址阶段-传输阶段-释放阶段
*   同步定时方式、异步定时方式（不互锁方式、半互锁方式、全互锁方式）

## 7.输入/输出系统

